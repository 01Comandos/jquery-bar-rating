(function(d){var m;("undefined"!==typeof window&&null!==window?window:global).BarRating=m=function(){function c(){this.show=function(){var a=this.$elem,b,c,e=this.options,h,k;if(!a.data("barrating")){k=e.initialRating?d('option[value="'+e.initialRating+'"]',a):d("option:selected",a);a.data("barrating",{currentRatingValue:k.val(),currentRatingText:k.text(),originalRatingValue:k.val(),originalRatingText:k.text()});b=d("<div />",{"class":"br-widget"}).insertAfter(a);a.find("option").each(function(){var a,
c;if(a=d(this).val())c=d(this).text(),a=d("<a />",{href:"#","data-rating-value":a,"data-rating-text":c}),c=d("<span />",{text:e.showValues?c:""}),b.append(a.append(c))});e.showSelectedRating&&b.append(d("<div />",{text:"","class":"br-current-rating"}));a.data("barrating").deselectable=a.find("option:first").val()?!1:!0;h=e.reverse?"nextAll":"prevAll";e.reverse&&b.addClass("br-reverse");e.readonly&&b.addClass("br-readonly");b.on("ratingchange",function(c,b,f){b=b?b:a.data("barrating").currentRatingValue;
f=f?f:a.data("barrating").currentRatingText;a.find('option[value="'+b+'"]').prop("selected",!0);a.change();e.showSelectedRating&&d(this).find(".br-current-rating").text(f)}).trigger("ratingchange");b.on("ratingstyle",function(c){b.find("a").removeClass("br-selected br-current");d(this).find('a[data-rating-value="'+a.data("barrating").currentRatingValue+'"]').addClass("br-selected br-current")[h]().addClass("br-selected")}).trigger("ratingstyle");c=b.find("a");c.on("touchstart",function(a){a.preventDefault();
a.stopPropagation();d(this).click()});if(e.readonly)c.on("click",function(a){a.preventDefault()});e.readonly||(c.on("click",function(l){var g=d(this),f;l.preventDefault();c.removeClass("br-active br-selected");g.addClass("br-selected")[h]().addClass("br-selected");l=g.attr("data-rating-value");f=g.attr("data-rating-text");g.hasClass("br-current")&&a.data("barrating").deselectable?(g.removeClass("br-selected br-current")[h]().removeClass("br-selected br-current"),f=l=""):(c.removeClass("br-current"),
g.addClass("br-current"));a.data("barrating").currentRatingValue=l;a.data("barrating").currentRatingText=f;b.trigger("ratingchange");e.onSelect.call(this,a.data("barrating").currentRatingValue,a.data("barrating").currentRatingText);return!1}),c.on({mouseenter:function(){var a=d(this);c.removeClass("br-active").removeClass("br-selected");a.addClass("br-active")[h]().addClass("br-active");b.trigger("ratingchange",[a.attr("data-rating-value"),a.attr("data-rating-text")])}}),b.on({mouseleave:function(){c.removeClass("br-active");
b.trigger("ratingchange").trigger("ratingstyle")}}));a.hide()}};this.set=function(a){this.$elem.find('option[value="'+a+'"]').val()&&(this.$elem.data("barrating").currentRatingValue=a,this.$elem.data("barrating").currentRatingText=this.$elem.find('option[value="'+a+'"]').text(),this.$widget.trigger("ratingchange").trigger("ratingstyle"))};this.clear=function(){this.$elem.data("barrating").currentRatingValue=this.$elem.data("barrating").originalRatingValue;this.$elem.data("barrating").currentRatingText=
this.$elem.data("barrating").originalRatingText;this.$widget.trigger("ratingchange").trigger("ratingstyle");this.options.onClear.call(this,this.$elem.data("barrating").currentRatingValue,this.$elem.data("barrating").currentRatingText)};this.destroy=function(){var a=this.$elem.data("barrating").currentRatingValue,b=this.$elem.data("barrating").currentRatingText;this.$elem.removeData("barrating");this.$widget.off().remove();this.$elem.show();this.options.onDestroy.call(this,a,b)}}c.prototype.init=function(a,
b){this.elem=b;this.$elem=d(this.elem);return this.options=d.extend({},d.fn.barrating.defaults,a)};return c}();d.fn.barrating=function(c,a){return this.each(function(){var b=new m;d(this).is("select")||d.error("Sorry, this plugin only works with select fields.");if(b.hasOwnProperty(c)){b.init(a,this);if("show"==c)return b.show(a);b.$widget=d(this).next(".br-widget");if(b.$widget&&b.$elem.data("barrating"))return b[c](a)}else if("object"!==typeof c&&c)d.error("Method "+c+" does not exist on jQuery.barrating");
else return a=c,b.init(a,this),b.show()})};return d.fn.barrating.defaults={initialRating:null,showValues:!1,showSelectedRating:!0,reverse:!1,readonly:!1,onSelect:function(c,a){},onClear:function(c,a){},onDestroy:function(c,a){}}})(jQuery);
