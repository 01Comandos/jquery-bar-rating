(function(d){var b,a,c;a=typeof window!=="undefined"&&window!==null?window:global;c="ontouchstart" in a;a.BarRating=b=(function(){function e(){this.show=function(){var j=d(this.elem),k=this.options,i=j.data("barrating"),l,h,g,f=c?"touchstart":"click";j.data("barrating",{initialized:true,currentRatingValue:j.val(),currentRatingText:d("option:selected",j).text()});if(!i||i.initialized===false){l=d("<div />",{"class":"bar-rating"}).insertAfter(this.elem);d(this.elem).find("option").each(function(){var q,p,n,o,m;q=d(this).val();p=d(this).text();n=(k.showValues)?p:"";o=d("<a />",{href:"#","data-rating-value":q,"data-rating-text":p});m=d("<span />",{text:n});l.append(o.append(m))});if(k.showSelectedRating){l.append(d("<div />",{text:"","class":"current-rating"}));l.find(".current-rating").on("ratingchange",function(){d(this).text(j.data("barrating").currentRatingText)}).trigger("ratingchange")}g=function(){if(j.data("barrating").currentRatingValue!==undefined){l.find('a[data-rating-value="'+j.data("barrating").currentRatingValue+'"]').addClass("selected current").prevAll().addClass("selected")}};g();h=l.find("a");if(c){h.on("click",function(m){m.preventDefault()})}h.on(f,function(m){var n=d(this);m.preventDefault();h.removeClass("active selected current");n.addClass("selected current").prevAll().addClass("selected");j.data("barrating").currentRatingValue=n.attr("data-rating-value");j.data("barrating").currentRatingText=n.attr("data-rating-text");j.val(n.attr("data-rating-value"));l.find(".current-rating").trigger("ratingchange");return false});if(!c){h.on({mouseenter:function(){var m=d(this);h.removeClass("active").removeClass("selected");m.addClass("active").prevAll().addClass("active")}});l.on({mouseleave:function(){h.removeClass("active");g()}})}j.hide()}};this.destroy=function(){var f=d(this.elem);f.removeData("barrating");d(".bar-rating, .bar-rating a").off().remove();f.show()}}e.prototype.init=function(g,h){var f;f=this;f.elem=h;return f.options=d.extend({},d.fn.barrating.defaults,g)};return e})();d.fn.barrating=function(f,e){return this.each(function(){var g=new b();if(g.hasOwnProperty(f)){g.init(e,this);return g[f]()}else{if(typeof f==="object"||!f){e=f;g.init(e,this);return g.show()}else{d.error("Method "+f+" does not exist on jQuery.barrating")}}})};return d.fn.barrating.defaults={showValues:false,showSelectedRating:true}})(jQuery);